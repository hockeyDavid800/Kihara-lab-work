# Kihara-lab-work
The objective of the python files is to create a PDF that lists all outlier dihedral angles and outlier atom distances of individual PDB files that were generated by machine learning.
A graduate student in the Kihara lab is creating a program that takes in an RNA sequence and outputs a model structure. The programs in this repository were made made to help validate his work by identifying outlier angles and distances.
The purpose of PDB_get_mean_and_stdev.py is to get the mean and standered deviation values from verified RSCB structures and store them in two CSV files. 
PDB_get_outliers.py will calculate the use the mean and standered deviation to calculate the z score for all angles and atom distances in a PDB file generated by machine learning. Angles and distances with a Z-score less than -2 or greater than 2 will be identified as outliers and will be printed in the PDF output, along with other important details.

Make sure PDB_get_outliers.py, PDB_get_mean_and_stdev.py,find_deviant_angles.py, find_deviant_distances.py, and draw_angle_histogram.py are all in the same folder.
You do not need to run find_deviant_angles.py and find_deviant_distances.py. However, they contain functions that are used in PDB_get_outliers.py, PDB_get_mean_and_stdev.py, and draw_angle_histogram.py.

How to use:
How to use the python files:
1. open PDB_get_mean_and_stdev.py
2. In Line 60 of PDB_get_mean_and_stdev.py , change the directory to the folder where you store all base RSCB RNA PDB structure files.
3. In lines 36 and 47, change the directory to where you want to create the csv files that will contain the mean and standered deviation of the angle types and atoms distances of the RSCB files
4. Run PDB_get_mean_and_stdev.py to generate two csv files. These csv files contain the mean and standard devation values of all dihedral angle types and the distance between each atom pair. For accurate results, run the program with as much RSCB files as possible.
5. Open PDB_get_outliers.py
6. In PDB_get_outliers, change line 57 and line 78 to the directories where you store the angles.csv and distances.csv
7. change line 99 to the directory where you store your computer generated RNA structure PDB files.
8. change the directory in line 118 to where you want to generate your pdf files that the outlier values
9. Run PDB_get_outliers.py to generate the PDF files
Each PDF file has 3 pages. The first page contains an image of the RNA structure. The second page contains a list of all the outlier angle values. The last page contains a list of all outlier angle distances
You can run draw_angle_histogram.py to create histograms that compare the RSCB angle values to the angles generated by the machine learning program and the outlier angles to validate the accuracy of PDB_get_outliers.py's output

Sample PDB files:
1c0a.pdb is the actual structure of 1c0a that was verified by scientists and posted on RSCB. 281_36031_1C0A_B.pdb is an attempt to replicate 1c0a by inputing 1c0a's sequence into the graduate student's program. 281_36031_1C0A_B_overview.pdf is the output from running PDB_get_outliers. The output shows the atoms that have deviant angles and distances.
